(()=>{"use strict";const e=e=>{const t=e.closest(".club-select").querySelector(".clubs-list ul");"block"===t.style.display?t.style.display="none":t.style.display="block"},t=(e,t)=>{const n=e.target;(n.classList.contains("overlay")||n.closest(".close-form")||n.classList.contains("close-btn"))&&(t.style.display="none")},n=()=>{const e=document.getElementById("free_visit_form");e.style.display="block",e.addEventListener("click",(n=>t(n,e)))},l=e=>{if(e.closest(".head-main")){const e=document.getElementById("callback_form");e.style.display="block",e.addEventListener("click",(n=>t(n,e)))}},r=e=>{e.style.display="none";const n=document.getElementById("gift");n.style.display="block",n.addEventListener("click",(e=>t(e,n)))},c=(e,n=!1,l)=>{let r;const c=document.createElement("div");c.className="send-status";const s=document.createElement("div");s.className="send-status",s.innerHTML='<div class="sk-wave sk-center">\n                                    <div class="sk-wave-rect"></div>\n                                    <div class="sk-wave-rect"></div>\n                                    <div class="sk-wave-rect"></div>\n                                    <div class="sk-wave-rect"></div>\n                                    <div class="sk-wave-rect"></div>\n                                </div>',l&&l.addEventListener("click",(e=>t(e,l))),e.querySelectorAll('input[type = "checkbox"]').forEach((e=>{e.closest(".personal-data")&&e.removeAttribute("required")})),e.addEventListener("submit",(t=>{t.preventDefault();const a=(e=>{const t=e.querySelector('input[name = "phone"]'),n=e.querySelector('input[name = "name"]'),l=e.querySelector('input[type = "checkbox"]'),r=t.value.replace(/\D/g,"").length;return n&&n.value.split(" ")[0].length<2?(n.focus(),"В имени не может быть менее одного символа! "):l&&!l.checked?"Не получено согласие на обработку персональных данных!":r<11?(t.focus(),"Телефонный номер не может быть короче 11 цифр!"):"OK"})(e);if("OK"!==a)return c.textContent=a,e.appendChild(c),void setTimeout((()=>{c.textContent="",e.removeChild(c)}),2e3);const o=new FormData(e);n&&(r=e.innerHTML),e.appendChild(s);const i={};var d;o.forEach(((e,t)=>{i[t]=e})),(d=JSON.stringify(i),fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:d})).then((t=>{if(e.removeChild(s),200!==t.status)throw new Error("response status not 200");c.textContent="Спасибо! Данные отправлены!",n?(e.innerHTML="",e.appendChild(c)):l.style.display="block"})).catch((t=>{console.error(t),n?(c.textContent="Что-то пошло не так...",e.innerHTML="",e.appendChild(c)):(l.querySelector(".form-content").innerHTML="\n                    <h4>Ошибка !</h4>\n                <p>Ваша заявка не была отправлена.</p>\n                       ",l.style.display="block")})).finally((()=>{setTimeout((()=>{n&&(c.textContent="",e.innerHTML=r),console.log("before_clear"),(e=>{e.querySelectorAll('input[name="name"]').forEach((e=>e.value="")),e.querySelectorAll('input[name="phone"]').forEach((e=>e.value="")),e.querySelectorAll('input[type="checkbox"]').forEach((e=>{e.closest(".personal-data")&&(e.checked=!1)}))})(e)}),3e3),n&&setTimeout((()=>{e.closest(".popup").style.display="none"}),2500)}))}))};(()=>{const t=[{elem:".club-select",fun:e},{elem:".open-popup",fun:n},{elem:".callback-btn",fun:l},{elem:".fixed-gift",fun:r}];document.querySelector("body").addEventListener("click",(e=>{(e=>{const n=e.target;for(let e=0;e<t.length;e++)if(null!==n.closest(t[e].elem)){t[e].fun(n);break}})(e)}))})(),(()=>{let e,t=0;document.querySelector(".head-slider");const n=document.querySelector(".main-slider"),l=n.querySelectorAll(".main-slider .slide"),r=()=>{l[t].style.display="none",t++,t=t>=l.length?0:t,l[t].style.display="flex"},c=(t=1500)=>{e=setInterval(r,t)};n.addEventListener("mouseover",(()=>clearInterval(e))),n.addEventListener("mouseout",(()=>c())),c(2e3)})(),(()=>{const e=document.querySelector(".services-slider"),t=e.innerHTML;e.innerHTML="";const n=document.createElement("div");n.className="service-slide__wrapper",n.innerHTML=t,e.insertAdjacentElement("afterbegin",n);let l,r,c=0;const s=n.querySelectorAll(".slide"),a=Math.floor(10);(()=>{e.classList.add("glo-slider"),n.classList.add("glo-slider__wrap");for(const e of s)e.classList.add("glo-slider__item")})(),r=document.createElement("div"),l=document.createElement("div"),r.className="slider-arrow prev",l.className="slider-arrow next",r.innerHTML='<span><img src="./images/arrow-left.png" alt=""></span> ',l.innerHTML='<span><img src="./images/arrow-right.png" alt=""></span> ',e.insertAdjacentElement("beforeend",r),e.insertAdjacentElement("beforeend",l),r.addEventListener("click",(()=>{c>0&&(--c,c<0&&(c=s.length-5),n.style.transform=`translateX(-${c*a}%)`)})),l.addEventListener("click",(()=>{c<s.length-5&&(++c,c>s.length-5&&(c=0),n.style.transform=`translateX(-${c*a}%)`)}))})(),(()=>{document.querySelectorAll('input[name="name"]').forEach((e=>e.setAttribute("maxlength","28"))),function(e,t="+7 (___) ___-__-__"){const n=document.querySelectorAll(e);function l(e){const n=e.keyCode,l=t,r=l.replace(/\D/g,""),c=this.value.replace(/\D/g,"");let s=0,a=l.replace(/[_\d]/g,(e=>s<c.length?c.charAt(s++)||r.charAt(s):e));s=a.indexOf("_"),-1!==s&&(a=a.slice(0,s));let o=l.substr(0,this.value.length).replace(/_+/g,(e=>"\\d{1,"+e.length+"}")).replace(/[+()]/g,"\\$&");o=new RegExp("^"+o+"$"),(!o.test(this.value)||this.value.length<5||n>47&&n<58)&&(this.value=a),"blur"===e.type&&this.value.length<5&&(this.value="")}for(const e of n)e.addEventListener("input",l),e.addEventListener("focus",l),e.addEventListener("blur",l)}('input[name="phone"]');document.querySelectorAll('input[name="name"]').forEach((e=>e.addEventListener("input",(()=>e.value=e.value.replace(/[^а-яёА-ЯЁ ]/gi,"")))));document.querySelectorAll('input[name="name"]').forEach((e=>e.addEventListener("blur",(()=>{e.value=e.value.replace(/^[ -]*/,""),e.value=e.value.replace(/[ -]*$/,""),e.value=e.value.replace(/ +/g," "),e.value=e.value.replace(/-+/g,"-"),"name"===e.name&&(e.value=e.value.replace(/[а-яА-Я]+/g,(e=>e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase())))}))))})(),c(document.querySelector('form[name="free-visit-form"]'),!0),c(document.querySelector('form[name="callback-form"]'),!0),c(document.querySelector('form[name="banner-form"]'),!1,document.querySelector("#thanks")),c(document.querySelector("#card_order"),!1,document.querySelector("#thanks")),c(document.querySelector("#footer_form"),!1,document.querySelector("#thanks")),(()=>{const e={schelkovo:{1:2990,6:14990,9:21990,12:24990},mozaika:{1:1999,6:9900,9:13900,12:19900}},t=document.querySelectorAll('#card_order input[name="club-name"]'),n=document.querySelectorAll("#card_order .time input"),l=document.getElementById("price-total"),r=()=>{let r;console.log("caunt"),t.forEach((e=>{e.checked&&(r=e.value)}));for(let t=0;t<n.length;t++)n[t].checked&&(console.log("club",e[r]),l.textContent=e[r][n[t].value],console.log("cardItems.value: ",n[t]))};t.forEach((e=>e.addEventListener("input",r))),n.forEach((e=>e.addEventListener("input",r)))})()})();